<p-card>
<p-toast></p-toast>
<p-toolbar>
    <ng-template pTemplate="left">
        <button pButton pRipple type="button" icon="pi pi-user"
            class="p-button-rounded p-button-info p-button-text p-button-sm" label="{{operacion.razon}}">
        </button>

        <button pButton pRipple type="button" icon="pi pi-bookmark"
            class="p-button-rounded p-button-info p-button-text p-button-sm"
            onclick="console.log('Modifico el cliente')" label="{{operacion.resp}}">
        </button>
        <button pButton pRipple type="button" icon="pi pi-print" id="print-btn"
            class="p-button-rounded p-button-info p-button-text p-button-sm" label="Imprimir {{operacion.tipoDocName}}">
        </button>
    </ng-template>

    <ng-template pTemplate="right">
        <button pButton pRipple type="button" class="p-button-rounded p-button-success p-button-text">
            {{operacion.total | currency:'USD'}}
        </button>
        <button pButton pRipple type="button" class="p-button-rounded p-button-info p-button-text">
        </button>
    </ng-template>
</p-toolbar>
<p-divider></p-divider>

<p-table *ngIf="operacion" [value]="operacion.detalles" dataKey="id" editMode="row" [(selection)]="selectedDetalles">
    <ng-template pTemplate="header">
        <tr class="header-table"> 
            <th>Cantidad</th>
            <th>Detalle</th>
            <th>Unitario</th>
            <th>STotal</th>
            <th style="text-align:center">
                <button pButton pRipple type="button" icon="pi pi-plus"
                    class="p-button-rounded p-button-info p-button-text p-button-sm"
                    (click)="openDetallesAdd()">
                </button>
            </th>
            <th style="text-align:center"></th>
        </tr>
    </ng-template>
    <ng-template pTemplate="body" let-detalles let-editing="editing" let-ri="rowIndex">
        <tr [pEditableRow]="detalles"> 
            <td style="text-align:center">
                <p-cellEditor>
                    <ng-template pTemplate="input">
                        <input pInputText type="number" [(ngModel)]="detalles.cantidad">
                    </ng-template>
                    <ng-template pTemplate="output">
                        {{detalles.cantidad}}
                    </ng-template>
                </p-cellEditor>
            </td>
            <td>
                <p-cellEditor>
                    <ng-template pTemplate="input">
                        <input pInputText type="text" [(ngModel)]="detalles.detalle">
                    </ng-template>
                    <ng-template pTemplate="output">
                        {{detalles.detalle}}
                    </ng-template>
                </p-cellEditor>
            </td>
            <td>
                <p-cellEditor>
                    <ng-template pTemplate="input">
                        <input pInputText type="number" [(ngModel)]="detalles.unitario">
                    </ng-template>
                    <ng-template pTemplate="output">
                        {{detalles.unitario | currency:'USD'}}
                    </ng-template>
                </p-cellEditor>
            </td>
            <td>
                {{detalles.total | currency:'USD'}}
            </td>
            <td style="text-align:center">
                <button *ngIf="!editing" pButton pRipple type="button" pInitEditableRow icon="pi pi-pencil"
                    (click)="onRowEditInit(detalles)" class="p-button-rounded p-button-text"></button>
                <button *ngIf="editing" pButton pRipple type="button" pSaveEditableRow icon="pi pi-check" (click)="onRowEditSave(detalles,ri)"
                    class="p-button-rounded p-button-text p-button-success p-mr-2">
                </button>                 
                <button *ngIf="editing" pButton pRipple type="button" pCancelEditableRow icon="pi pi-times"
                    (click)="onRowEditCancel(detalles, ri)"
                    class="p-button-rounded p-button-text p-button-danger">
                </button>
            </td>
            <td style="text-align:center">
                <button pButton pRipple type="button" class="p-button-rounded p-button-text p-button-danger p-mr-2"
                (click)="deleteDetalle(detalles.id)" icon="pi pi-trash">
                </button>
            </td>
        </tr>
    </ng-template>
</p-table> 
</p-card>
<p-confirmDialog [style]="{width: '450px'}"></p-confirmDialog>
<p-dialog  header="Productos" [(visible)]="visibleProductos" [style]="{width: '80vw', height: 'auto'}" position="right">  
    <ng-container #addDetallesContainer></ng-container>
</p-dialog>
